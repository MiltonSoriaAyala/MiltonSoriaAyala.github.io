---
title: Practica 01 sobre Kill Chain
date: 2024-10-10 00:00:00 +05:00
categories: [reconnaisance, kill chain, pentesting]
tags: [nmap, kali, metaxploid, SSH, vssown, handshake]  # TAG names should always be lowercase
---

# **¿Qué es Cyber Security Kill Chain?**

El modelo de la Kill Chain de la ciberseguridad explica el procedimiento típico que siguen los ciberdelincuentes para completar un ataque cibernético con éxito. Se trata de un marco desarrollado por Lockheed Martin, derivado de los modelos de ataque militares y trasladado al mundo digital para ayudar a los equipos a comprender, detectar y prevenir las ciberamenazas persistentes. Aunque no todos los ciberataques aplicarán los siete pasos del modelo de la Kill Chain de la ciberseguridad, la inmensa mayoría de los ataques los utilizan casi todos, a menudo abarcando del paso 2 al paso 6.

![figure](/assets/images/killChain.png) 
fuente: [https://www.netskope.com/es/security-defined/cyber-security-kill-chain](https://www.netskope.com/es/security-defined/cyber-security-kill-chain)

# Pasos típicos del Kill Chain en Ciberseguridad

## Paso 1: Reconocimiento
Los ciberataques más efectivos inician con una fase de reconocimiento, donde los atacantes realizan una recopilación exhaustiva de información sobre su objetivo. Esta etapa implica el uso de herramientas avanzadas y técnicas, como motores de búsqueda, análisis de metadata, servicios en la nube y protocolos de red (como WHOIS y DNS). Los atacantes buscan identificar vulnerabilidades en aplicaciones, redes y bases de datos especialmente aquellas alojadas en la nube—exponiendo puntos débiles que podrían ser explotados en etapas posteriores. Proteger la información sensible mediante prácticas como el cifrado robusto y la implementación de defensas en la nube es crucial para mitigar el riesgo de que los atacantes accedan a datos confidenciales.

## Paso 2: Preparación
Tras reunir suficiente información, los atacantes seleccionan vectores de ataque específicos para llevar a cabo la intrusión. Un vector de ataque es un método o técnica utilizada para obtener acceso no autorizado, y los ciberdelincuentes evalúan el costo y el retorno potencial de cada objetivo, optando generalmente por las rutas de menor resistencia. Los vectores comunes incluyen credenciales inseguras, acceso remoto sin protección (RDP, SSH), y ataques de ingeniería social como el phishing. Esto subraya la importancia de realizar auditorías de seguridad y reforzar todos los puntos de acceso potencialmente vulnerables en la infraestructura.

## Paso 3: Distribución
Una vez dentro del sistema, los atacantes tienen la capacidad de distribuir cargas maliciosas, como malware o ransomware, configurando ataques que pueden ser inmediatos o programados. Con un creciente porcentaje de estos ataques llevándose a cabo a través de la nube, es esencial implementar servicios de escaneo de amenazas y análisis de comportamiento en tiempo real. Monitorear el tráfico web y en la nube, así como la salud de los dispositivos de endpoint, se vuelve indispensable para garantizar que la red permanezca libre de infecciones y que las amenazas sean neutralizadas antes de causar daños.

## Paso 4: Explotación
Después de la distribución del malware, el atacante inicia la explotación del sistema, que puede ocurrir de forma inmediata o ser desencadenada por acciones específicas del usuario, como ejecutar un archivo adjunto malicioso. Estos programas a menudo emplean técnicas de ofuscación y evasión para ocultar su actividad, dificultando su detección por parte de las soluciones de seguridad. Esta fase es crítica, ya que el éxito de la explotación puede permitir al atacante obtener acceso a datos sensibles o comprometer aún más la infraestructura de TI.

## Paso 5: Instalación
Si el atacante busca mantener un acceso persistente, procederá a instalar una puerta trasera que le permita reingresar al sistema sin ser detectado. Estas puertas traseras pueden ser configuradas mediante rootkits o aprovechando credenciales débiles. La detección de estas intrusiones es particularmente complicada, ya que pueden operar en silencio y sin generar alertas evidentes. Por ello, es fundamental contar con una arquitectura de seguridad integral que incluya monitoreo de logs, análisis de comportamiento y detección de anomalías para identificar intrusiones.

## Paso 6: Comando y Control
Con el malware y las puertas traseras instaladas, el atacante establece un canal de comando y control para gestionar sus operaciones dentro del sistema comprometido. Este control permite al atacante ejecutar acciones maliciosas, como la instalación de ransomware o la exfiltración de datos. La implementación de medidas de seguridad que supervisen el tráfico de red y analicen patrones de comportamiento se vuelve esencial, ya que detectar actividades inusuales de forma proactiva puede prevenir la escalada del ataque y limitar el daño potencial.

## Paso 7: Acciones sobre los Objetivos
Finalmente, en esta fase crítica, el atacante lleva a cabo acciones específicas sobre el objetivo, que pueden incluir el cifrado de datos para exigir un rescate, la exfiltración de información sensible o la ejecución de ataques de denegación de servicio. La vigilancia y el espionaje son tácticas comunes en esta etapa, lo que hace imperativo que las organizaciones implementen un monitoreo continuo y análisis en tiempo real de las actividades en sus sistemas. Una respuesta proactiva y bien estructurada ante anomalías puede ser decisiva para mitigar el impacto de un ataque y proteger los activos críticos de la organización.

# **Desarrollo del laboratorio Kill Chain**

A continiación se detalla paso a paso el desarrollo del laboratorio de clase, las mismas que van a ir acompañados de las respuestas a las preguntas de la Práctca 01 (P01-Kill Chain).

## **Etapa 1: Reconnaissance**

Identificamos la ip del target:


Ejecutamos el comando ipconfig en el PowerShell de Windows:
```shell
ipconfig
```
Aqui identificamos la ip del objetivo (10.0.2.4) 
![figure](/assets/images/ipconfig.jpeg)



Ejecutamos el comando:
```bash
sudo nmap -sV -p- 10.0.2.4
```

![figure](/assets/images/nmap1.jpeg)

El comando que se muestra en la figura está utilizando `nmap` para realizar un escaneo de puertos en un host específico (10.0.2.4). A continuación explico cada parte del comando y lo que está realizando:

### Desglose del Comando

1. **`sudo`**: Este comando se utiliza para ejecutar `nmap` con privilegios de superusuario (root). Esto permite que `nmap` realice operaciones avanzadas que requieren acceso completo a la red.
2. **`nmap`**: Es la herramienta que se está utilizando para escanear la red y los puertos.
3. **`-p-`**: Esto indica que se escanearán todos los puertos (del 1 al 65535). Esto es útil para obtener un panorama completo de los servicios que están escuchando en el host.
4. **`-sV`**: Este flag se utiliza para detectar versiones de los servicios que se están ejecutando en los puertos abiertos.
5. **`10.0.2.4`**: Este es el objetivo del escaneo, que es la dirección IP del host que se está analizando.

### Resultados del Escaneo

- **`PORT`**: Muestra los puertos que han sido escaneados.
- **`STATE`**: Indica si el puerto está abierto, cerrado o filtrado.
- **`SERVICE`**: Muestra el servicio que se está ejecutando en cada puerto.

### Resultado del Escaneo para SSH

- **Puerto**: `22/tcp`
- **Estado**: `open`
- **Servicio**: `OpenSSH 7.9p1 (protocol 2.0)`

### Interpretación

1. **Puerto 22/tcp**: Este es el puerto estándar utilizado para el servicio SSH (Secure Shell), que proporciona una comunicación segura entre un cliente y un servidor.

2. **Estado `open`**: Indica que el puerto está abierto y que el servicio SSH está escuchando en ese puerto. Esto significa que se puede establecer una conexión SSH con el servidor.

3. **Servicio `OpenSSH 7.9p1 (protocol 2.0)`**: Identifica que el servicio en ejecución es OpenSSH, específicamente la versión 7.9p1, y que está utilizando el protocolo SSH 2.0. Esto es relevante para la seguridad, ya que las versiones más recientes suelen incluir mejoras y parches de seguridad.

### Conclusión

El escaneo ha identificado que el servicio SSH está activo y accesible en el servidor escaneado, lo que permite la conexión remota y segura a través de SSH.

## **Etapa 2: Weaponization**

### Uso de Metasploit Framework

Metasploit Framework es una herramienta de código abierto utilizada principalmente para pruebas de penetración y la explotación de vulnerabilidades en sistemas informáticos. Ofrece una extensa colección de módulos de exploits, payloads (códigos que se ejecutan en el sistema objetivo tras una explotación exitosa), y herramientas para escanear redes en busca de vulnerabilidades. Además, incluye módulos auxiliares para tareas como el escaneo de puertos y la recolección de información, y cuenta con tanto una interfaz de línea de comandos (`msfconsole`) como interfaces gráficas. Es fundamental en el campo de la ciberseguridad, permitiendo a los profesionales simular ataques reales, identificar debilidades y mejorar la defensa de infraestructuras tecnológicas, aunque su uso debe ser ético, legal y debe ser realizado en entornos controlados.

Sus principales usos son:

- **Pruebas de Penetración**: Metasploit es ampliamente utilizado por profesionales de la seguridad para identificar y explotar vulnerabilidades en sistemas.
- **Desarrollo de Exploits**: Proporciona un entorno para desarrollar y probar exploits.
- **Módulos de Exploit**: Contiene una extensa base de datos de exploits, payloads y herramientas para realizar diversas tareas de seguridad.
- **Manejo de Sesiones**: Permite gestionar sesiones de explotación y establecer conexiones de control sobre sistemas comprometidos.

### Desglose del Comando: msfconsole -q

1. **`msfconsole`**: Es la interfaz de línea de comandos de Metasploit. Permite a los usuarios interactuar con el framework para realizar tareas como escaneo, explotación y manejo de sesiones.

2. **`-q`**: Esta opción significa "quiet mode", o modo silencioso. Al usar esta opción, Metasploit inicia sin mostrar el banner de bienvenida y sin mensajes adicionales que normalmente aparecen al iniciar. Esto puede ser útil para aquellos que desean una experiencia más limpia o para scripts automatizados.

Luego de una previa explicación del comando, continuamos con el laboratorio y ejecutamos el comando:
```bash
msfconsole -q
```

![figure](/assets/images/msfconsole.jpeg)


```ruby
search ssh enum
```
Aqui identificamos la enumeración de usuarios SSH
![figure](/assets/images/enum.jpeg)

```ruby
use auxiliary(scanner/ssh/ssh_enumusers):
set RHOSTS 10.0.2.4
set USER_FILE /home/user/Downloads/CommonAdminBase64.txt
set VERBOSE true
show options
run
```
![figure](/assets/images/enum3.png)

Procediendo con el escaneo de la enumeración de usuarios SSH
![figure](/assets/images/run1.png)
![figure](/assets/images/run2.png)

```ruby
search ssh login
```

![figure](/assets/images/sshlogin.jpeg)

```ruby
use auxiliary(scanner/ssh/ssh_login):
set RHOSTS 10.0.2.4
set USER_FILE /home/user/Downloads/usewrname.txt
set PASS_FILE /home/user/Downloads/top-usernames-shortlist.txt
set VERBOSE true
show options
run
```
![figure](/assets/images/login2.png)

Procediendo a escanear con el objetivo de encontrar usuarios logueados con contraseñas detectables
![figure](/assets/images/login3.png)
![figure](/assets/images/login4.png)

Una vez logrado identificar el usuario y contraseña del objetivo ingresamos al shell de la maquina mediante SSH
![figure](/assets/images/ssh1.png)

Se realiza pruebas de reconocimiento y recoleccion de datos relevantes del objetivo
![figure](/assets/images/ssh2.png)

Finalmente se logra acceder al archivo SAM y SYSTEM de la maquina del objetivo y realizar una copia a la maquina atacante para una exploración mas exaustiva de datos relevantes del objetivo
![figure](/assets/images/system.png)

# **Respondiendo preguntas del laboratorio Kill Chain (PC01)**

## 1. ¿Porque debemos ejecutar nmap con privilegios de root?

Ejecutar `nmap` con privilegios de root (o administrador) proporciona varias ventajas importantes para el escaneo de redes y sistemas
### Razones para Ejecutar Nmap con Privilegios de Root

- **Acceso a Funciones Avanzadas**:
   Algunas características de `nmap`, como el escaneo de puertos en modo SYN (también conocido como "stealth scan"), requieren acceso a funciones de bajo nivel del sistema operativo que solo están disponibles para el usuario root.

- **Escaneo de Puertos Privados**:
   Los puertos por debajo del 1024 (puertos "bien conocidos") suelen requerir privilegios elevados para ser escaneados. Esto incluye servicios críticos como SSH (puerto 22), HTTP (puerto 80), y otros.

- **Detección de Sistemas Operativos**:
   Para realizar la detección de sistemas operativos (`-O`), `nmap` necesita enviar paquetes especiales que pueden requerir acceso root para manipular la pila de red adecuadamente.

- **Evitar Limitaciones**:
    Ejecutar `nmap` como usuario estándar puede limitar la capacidad de realizar ciertos tipos de escaneos o puede devolver resultados incompletos debido a restricciones impuestas por el sistema operativo.

- **Mejor Precisión en Resultados**:
   Al tener acceso completo al sistema, `nmap` puede realizar análisis más completos y precisos, lo que resulta en una mejor identificación de dispositivos y servicios en la red.

## 2. ¿Qué significan los flags -sS, -sT, -sV, -O en el escaneo de nmap?
Los flags en `nmap` especifican diferentes tipos de escaneos y técnicas que se utilizan para obtener información sobre los hosts y servicios en una red. Aquí te explico el significado de cada uno de los flags mencionados:

### Flags de Nmap

- **-sS (SYN Scan)**:
   Realiza un escaneo de tipo "stealth" o sigiloso. Envía un paquete SYN (solicitud de conexión) y espera la respuesta. Si recibe un SYN-ACK, el puerto está abierto; si recibe un RST, el puerto está cerrado. Este tipo de escaneo es menos detectable por los sistemas de seguridad.
```bash
$ nmap -sS 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:00 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0010s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```

- **-sT (TCP Connect Scan)**:
   Realiza un escaneo completo de conexión TCP. Esto implica establecer una conexión completa con el puerto (3 vías de apretón de manos TCP). Es más fácil de detectar y puede ser menos sigiloso que el escaneo SYN, pero es útil cuando no se tienen privilegios de root.

```bash
$ nmap -sT 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:05 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```

- **-sV (Service Version Detection)**:
   Intenta determinar la versión de los servicios que se están ejecutando en los puertos abiertos. Esto se hace enviando diversas solicitudes a los servicios y analizando las respuestas para identificar la versión del software.

```bash
$ nmap -sV 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:10 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0015s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Debian 4
80/tcp open  http    Apache httpd 2.4.29
```

- **-O (OS Detection)**:
   Intenta identificar el sistema operativo que está ejecutando el host objetivo. `nmap` envía paquetes específicos que pueden revelar información sobre la pila de red y otros rasgos característicos del sistema operativo.


```bash
$ nmap -O 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:15 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0018s latency).
Not shown: 998 closed ports
OS details: Linux 3.2 - 4.9
```
- **Combinación de Flags (-sS -sV)**:

```bash
$ nmap -sS -sV 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:20 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0020s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Debian 4
80/tcp open  http    Apache httpd 2.4.29
```
La combinación de flags -sS -sV en nmap se utiliza para realizar un escaneo de puertos sigiloso (SYN scan) y, al mismo tiempo, detectar las versiones de los servicios que se están ejecutando en los puertos abiertos. 

Mientras -sS (SYN Scan) realiza un escaneo sigiloso, enviando paquetes SYN para establecer una conexión inicial sin completar el proceso de conexión TCP. Este método es menos detectable por sistemas de seguridad, ya que no se establece una conexión completa.
Después de identificar los puertos abiertos, el flag -sV (Service Version Detection) intenta determinar la versión específica del servicio que se está ejecutando en esos puertos. nmap envía diferentes tipos de solicitudes a los servicios y analiza las respuestas para identificar la versión del software.

Al combinar estos dos flags, el comando permite:

- **Identificación Eficiente:** Realizar un escaneo de puertos de forma sigilosa para evitar alertar a sistemas de detección de intrusos (IDS) mientras también se recopila información detallada sobre las versiones de los servicios.
- **Mejor Comprensión del Entorno:** Obtener información crítica sobre qué servicios están disponibles y qué versiones se están utilizando, lo que es fundamental para evaluar vulnerabilidades y planificar pruebas de penetración.

## 3. ¿Existe algún flag que permite hacer un escaneo involucrando todos los flags mencionados anteriormente?

Exsisten varias combinaciones posibles, su uso depende de la necesidad de lo que se requiere realizar

A continuación algunos ejemplos:

### Escaneo SYN, Detección de Servicios y Detección de Sistema Operativo

```bash
$ nmap -sS -sV -O 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:00 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0010s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Debian 4
80/tcp open  http    Apache httpd 2.4.29
MAC Address: 00:11:22:33:44:55 (Vendor)
OS details: Linux 3.2 - 4.9
```

**Explicación**:
Este comando realiza un escaneo SYN sigiloso en la dirección IP `192.168.1.1`, detectando los servicios en los puertos abiertos y el sistema operativo. Muestra que los puertos 22 (SSH) y 80 (HTTP) están abiertos, junto con información de la versión del servicio y detalles del sistema operativo.

---

### Escaneo TCP Connect, Detección de Servicios y Detección de Sistema Operativo

```bash
$ nmap -sT -sV -O 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:05 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Debian 4
80/tcp open  http    Apache httpd 2.4.29
MAC Address: 00:11:22:33:44:55 (Vendor)
OS details: Linux 3.2 - 4.9
```

**Explicación**:
Este comando utiliza un escaneo TCP Connect, que establece conexiones completas. Al igual que el anterior, identifica los puertos 22 y 80 como abiertos, junto con la información de la versión y del sistema operativo. Es más detectable debido a que completa el proceso de conexión.

---

### Escaneo TCP Connect, Detección de Servicios y Escaneo de Puertos Específicos

```bash
$ nmap -sT -sV -p 22,80 192.168.1.1
Starting Nmap 7.80 ( https://nmap.org ) at 2023-10-12 12:10 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0015s latency).
PORT     STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Debian 4
80/tcp open  http    Apache httpd 2.4.29
```

**Explicación**:
En este caso, se realiza un escaneo TCP Connect enfocado solo en los puertos 22 y 80 de la dirección IP `192.168.1.1`. La salida confirma que ambos puertos están abiertos y proporciona detalles sobre los servicios, similar a los ejemplos anteriores, pero limitando el escaneo a puertos específicos para mayor eficiencia.

## 4. Explicar el proceso de un handshake TCP.


![figure](/assets/images/handshake.png)
fuente: [https://www.guru99.com/tcp-3-way-handshake.html](https://www.guru99.com/tcp-3-way-handshake.html)

El proceso de un **handshake TCP** es un mecanismo fundamental que establece una conexión confiable entre un cliente y un servidor en una red. El proceso se lleva a cabo en tres pasos, conocido como el **Three-Way Handshake**. Aquí te explico cada etapa:

### **SYN (Synchronize)**

- **Descripción**: El cliente envía un paquete TCP con el flag SYN (Synchronize) establecido al servidor para iniciar la conexión.
- **Objetivo**: Indicar al servidor que el cliente desea establecer una conexión y sincronizar los números de secuencia.
- **Contenido**: Este paquete incluye un número de secuencia inicial (ISN) del cliente.

### **SYN-ACK (Synchronize-Acknowledge)**

- **Descripción**: El servidor responde al cliente con un paquete TCP que tiene los flags SYN y ACK (Acknowledge) establecidos.
- **Objetivo**: Confirmar la recepción del paquete SYN del cliente y enviar su propio número de secuencia inicial.
- **Contenido**: Este paquete incluye el número de secuencia inicial del servidor y un número de reconocimiento (ACK) que es el ISN del cliente más uno.

### **ACK (Acknowledge)**

- **Descripción**: El cliente envía un paquete TCP al servidor con el flag ACK establecido.
- **Objetivo**: Confirmar la recepción del paquete SYN-ACK del servidor.
- **Contenido**: Este paquete incluye un número de reconocimiento que es el ISN del servidor más uno.

### Resumen del Proceso

- **Cliente → Servidor**: Envío de un paquete SYN con ISN del cliente.
- **Servidor → Cliente**: Respuesta con un paquete SYN-ACK, incluyendo ISN del servidor y ACK del cliente.
- **Cliente → Servidor**: Envío de un paquete ACK para confirmar la recepción del SYN-ACK del servidor.

### Resultado

Una vez completado este proceso, la conexión TCP se establece y ambos extremos pueden comenzar a enviar y recibir datos de manera confiable, utilizando el control de flujo y la corrección de errores que ofrece TCP. Este mecanismo asegura que ambos lados estén listos para la comunicación y que los números de secuencia estén sincronizados, lo que es esencial para la integridad de los datos transmitidos.

## 5. Según la pregunta anterior, ¿qué significa el flag -sS?

El flag `-sS` en `nmap` se refiere a un **SYN Scan**, que es una técnica de escaneo de puertos que utiliza el primer paso del proceso de handshake TCP, pero sin completarlo. Aquí te explico su significado y funcionamiento en este contexto:

### Significado de `-sS` (SYN Scan)

- **Escaneo Sigiloso**: El SYN Scan es conocido como un escaneo "sigiloso" porque envía paquetes SYN para iniciar una conexión sin completar el handshake TCP. Esto lo hace menos detectable por sistemas de seguridad que monitorean conexiones completas.
  
### Funcionamiento en el Contexto del Handshake TCP

1. **Envio de Paquete SYN**: Cuando se ejecuta un comando con `-sS`, `nmap` envía un paquete TCP con el flag SYN establecido al puerto objetivo. Esto inicia el proceso de handshake TCP.
   
2. **Respuestas Posibles**:
   - **SYN-ACK**: Si el puerto está abierto, el servidor responde con un paquete SYN-ACK, indicando que acepta la conexión.
   - **RST (Reset)**: Si el puerto está cerrado, el servidor responde con un paquete RST, indicando que no acepta la conexión.

3. **No Completar el Handshake**: Después de recibir la respuesta (ya sea SYN-ACK o RST), `nmap` no envía el paquete ACK final que completaría el handshake TCP. Esto significa que no se establece una conexión completa, lo que ayuda a evitar la detección por parte de sistemas de seguridad.

## 6. ¿Qué hace el flag --script?

El flag `--script` en `nmap` se utiliza para ejecutar scripts de la biblioteca de Nmap Scripting Engine (NSE). Estos scripts permiten realizar tareas avanzadas y específicas durante el escaneo, ampliando las capacidades de `nmap` más allá de un simple escaneo de puertos. Aquí te explico su uso y funcionalidades:

### Funciones del Flag `--script`

1. **Ejecutar Scripts NSE**: Permite ejecutar scripts específicos que pueden realizar diversas funciones, como detección de vulnerabilidades, recolección de información, ejecución de pruebas de seguridad, y más.

2. **Tipos de Scripts**: Los scripts pueden clasificarse en varias categorías, tales como:
   - **Vulnerabilidades**: Identifican vulnerabilidades conocidas en servicios.
   - **Exploración**: Recolectan información adicional sobre el sistema.
   - **Autenticación**: Realizan pruebas de autenticación en servicios como FTP, HTTP, etc.
   - **Pruebas de servicio**: Verifican la configuración y la seguridad de servicios específicos.

3. **Sintaxis**: La forma básica de usar el flag es:
   ```bash
   nmap --script [nombre_del_script] [target]
   ```
   También puedes usar `--script` seguido de un patrón, como `default` o `vuln`, para ejecutar múltiples scripts que coincidan.

### Ejemplo de Uso

**Comando:**
```bash
$ nmap --script http-vuln* 192.168.1.1
```

**Descripción**: Este comando ejecuta todos los scripts que comienzan con `http-vuln` en el host `192.168.1.1`, buscando vulnerabilidades en servicios HTTP.


### Conclusiones

- Ejecutar `nmap` con privilegios de root permite acceder a funciones avanzadas, escanear puertos bien conocidos, detectar sistemas operativos y mejorar la precisión de los resultados, lo que es esencial para un escaneo de red efectivo y completo. Sin embargo, siempre se debe hacer de manera ética y legal, respetando las políticas de red y seguridad.

- El uso de flags combinados en `nmap` permite realizar análisis de red más detallados y eficientes, adaptando los escaneos a necesidades específicas de evaluación de seguridad. Al combinar métodos como `-sS` (SYN Scan) o `-sT` (TCP Connect) con detección de versiones (`-sV`) y de sistemas operativos (`-O`), se obtiene una visión completa del entorno de red, lo que ahorra tiempo y esfuerzo, proporciona información precisa sobre servicios y versiones, y permite una mejor toma de decisiones. Esta flexibilidad y precisión en el escaneo son fundamentales para identificar vulnerabilidades y mantener la seguridad en un entorno cada vez más amenazante.

- En resumen, el flag `--script` en `nmap` es una herramienta poderosa que permite a los usuarios aprovechar los scripts NSE para realizar análisis de seguridad más profundos y específicos, facilitando la detección de vulnerabilidades y la recolección de información valiosa sobre los sistemas evaluados.



